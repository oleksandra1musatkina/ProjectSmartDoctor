<p *ngIf="error" class="error">{{error | json}}</p>

<div class="card shadow-lg">
  <!--<img class="card-img-top" src="assets/doctor.jpg" alt="Card image cap">-->
  <img *ngIf="doctor && doctor.image" class="card-img-top" src="assets/uploads/{{doctor.image}}" height="250"
       alt="Card image cap">
  <img *ngIf="!doctor || !doctor.image" class="card-img-top" src="assets/doctor.jpg" alt="Card image cap" height="250">
  <div class="card-body">
    <div class="text-center">

      <h5 class="card-title">{{doctor.firstname}} {{doctor.surname}}</h5>
      <p class="card-text">Opening hours.</p>
      <table class="align-middle">
        <tr>
          <td>
            Mon
          </td>
          <td *ngIf="doctor.opening.mon.open">{{doctor.opening.mon.open}}</td>
          <td *ngIf="!doctor.opening.mon.open">--:--</td>
          <td>
            -
          </td>
          <td *ngIf="doctor.opening.mon.close">{{doctor.opening.mon.close}}</td>
          <td *ngIf="!doctor.opening.mon.close">--:--</td>
        </tr>
        <tr>
          <td>
            Tue
          </td>
          <td *ngIf="doctor.opening.tue.open">{{doctor.opening.tue.open}}</td>
          <td *ngIf="!doctor.opening.tue.open">--:--</td>
          <td>
            -
          </td>
          <td *ngIf="doctor.opening.tue.close">{{doctor.opening.tue.close}}</td>
          <td *ngIf="!doctor.opening.tue.close">--:--</td>
        </tr>
        <tr>
          <td>
            Wed
          </td>
          <td *ngIf="doctor.opening.wed.open">{{doctor.opening.wed.open}}</td>
          <td *ngIf="!doctor.opening.wed.open">--:--</td>
          <td>
            -
          </td>
          <td *ngIf="doctor.opening.wed.close">{{doctor.opening.wed.close}}</td>
          <td *ngIf="!doctor.opening.wed.close">--:--</td>
        </tr>
        <tr>
          <td>
            Thu
          </td>
          <td *ngIf="doctor.opening.thu.open">{{doctor.opening.thu.open}}</td>
          <td *ngIf="!doctor.opening.thu.open">--:--</td>
          <td>
            -
          </td>
          <td *ngIf="doctor.opening.thu.close">{{doctor.opening.thu.close}}</td>
          <td *ngIf="!doctor.opening.thu.close">--:--</td>
        </tr>
        <tr>
          <td>
            Fri
          </td>
          <td *ngIf="doctor.opening.fri.open">{{doctor.opening.fri.open}}</td>
          <td *ngIf="!doctor.opening.fri.open">--:--</td>
          <td>
            -
          </td>
          <td *ngIf="doctor.opening.fri.close">{{doctor.opening.fri.close}}</td>
          <td *ngIf="!doctor.opening.fri.close">--:--</td>
        </tr>
        <tr>
          <td>
            Sat
          </td>
          <td *ngIf="doctor.opening.sat.open">{{doctor.opening.sat.open}}</td>
          <td *ngIf="!doctor.opening.sat.open">--:--</td>
          <td>
            -
          </td>
          <td *ngIf="doctor.opening.sat.close">{{doctor.opening.sat.close}}</td>
          <td *ngIf="!doctor.opening.sat.close">--:--</td>
        </tr>
        <tr>
          <td>
            Sun
          </td>
          <td *ngIf="doctor.opening.sun.open">{{doctor.opening.sun.open}}</td>
          <td *ngIf="!doctor.opening.sun.open">--:--</td>
          <td>
            -
          </td>
          <td *ngIf="doctor.opening.sun.close">{{doctor.opening.sun.close}}</td>
          <td *ngIf="!doctor.opening.sun.close">--:--</td>
        </tr>
      </table>
    </div>

    <div class="well well-sm">
      <div class="row">
        <div class="col-xs-12 col-md-6 text-center">
          <h1 class="rating-num"> {{score}}</h1>
          <div class="rating">
            <span [ngClass]="(score > 0 )?'fa fa-star':'fa fa-star-o'"></span>
            <span [ngClass]="(score > 1 )?'fa fa-star':'fa fa-star-o'"></span>
            <span [ngClass]="(score > 2 )?'fa fa-star':'fa fa-star-o'"></span>
            <span [ngClass]="(score > 3 )?'fa fa-star':'fa fa-star-o'"></span>
            <span [ngClass]="(score > 4 )?'fa fa-star':'fa fa-star-o'"></span>
          </div>
          <div>
            <span class="fa fa-user"></span>{{numberOfRatins}} total
          </div>
        </div>
        <div class="col-xs-12 col-md-6">
          <div class="row rating-desc">
            <div class="col-xs-3 col-md-3 text-right">
              <span class="fa fa-star">5</span>
            </div>
            <div class="col-xs-8 col-md-9">
              <div class="progress progress-striped">
                <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="20"
                     aria-valuemin="0" aria-valuemax="100" [ngStyle]="{'width' : fiveStarsPercentage+'%'}">
                  <span class=" sr-only            ">80%</span>
                </div>
              </div>
            </div>
            <!-- end 5 -->
            <div class="col-xs-3 col-md-3 text-right">
              <span class="fa fa-star">4</span>
            </div>
            <div class="col-xs-8 col-md-9">
              <div class="progress">
                <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="20"
                     aria-valuemin="0" aria-valuemax="100" [ngStyle]="{'width' : fourStarsPercentage+'%'}">
                  <span class="sr-only">60%</span>
                </div>
              </div>
            </div>
            <!-- end 4 -->
            <div class="col-xs-3 col-md-3 text-right">
              <span class="fa fa-star">3</span>
            </div>
            <div class="col-xs-8 col-md-9">
              <div class="progress">
                <div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="20"
                     aria-valuemin="0" aria-valuemax="100" [ngStyle]="{'width' : threeStarsPercentage+'%'}">
                  <span class="sr-only">40%</span>
                </div>
              </div>
            </div>
            <!-- end 3 -->
            <div class="col-xs-3 col-md-3 text-right">
              <span class="fa fa-star">2</span>
            </div>
            <div class="col-xs-8 col-md-9">
              <div class="progress">
                <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="20"
                     aria-valuemin="0" aria-valuemax="100" [ngStyle]="{'width' : twoStarsPercentage+'%'}">
                  <span class="sr-only">20%</span>
                </div>
              </div>
            </div>
            <!-- end 2 -->
            <div class="col-xs-3 col-md-3 text-right">
              <span class="fa fa-star">1</span>
            </div>
            <div class="col-xs-8 col-md-9">
              <div class="progress">
                <div class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="80"
                     aria-valuemin="0" aria-valuemax="100" [ngStyle]="{'width' : oneStarsPercentage+'%'}">
                  <span class="sr-only">15%</span>
                </div>
              </div>
            </div>
            <!-- end 1 -->
          </div>
          <!-- end row -->
        </div>
      </div>
    </div>
    <div class="row" *ngIf="!wasRated">
      <div class="col-12 text-center">
        Rate now:
        <span class="text-center ">
      <span (mouseover)="rateOne=true" (mouseleave)="rateOne=false" (click)="addDoctorRating(doctor._id, 1)"
            [ngClass]="(rateOne==true || rateTwo==true || rateThree==true || rateFour==true || rateFive==true)?'fa fa-2x fa-star':'fa fa-2x fa-star-o'"></span>
      <span (mouseover)="rateTwo=true" (mouseleave)="rateTwo=false" (click)="addDoctorRating(doctor._id, 2)"
            [ngClass]="(rateTwo==true || rateThree==true || rateFour==true || rateFive==true)?'fa fa-2x fa-star':'fa fa-2x fa-star-o'"></span>
      <span (mouseover)="rateThree=true" (mouseleave)="rateThree=false" (click)="addDoctorRating(doctor._id, 3)"
            [ngClass]="(rateThree==true || rateFour==true || rateFive==true)?'fa fa-2x fa-star':'fa fa-2x fa-star-o'"></span>
      <span (mouseover)="rateFour=true" (mouseleave)="rateFour=false" (click)="addDoctorRating(doctor._id, 4)"
            [ngClass]="(rateFour==true || rateFive==true)?'fa fa-2x fa-star':'fa fa-2x fa-star-o'"></span>
      <span (mouseover)="rateFive=true" (mouseleave)="rateFive=false" (click)="addDoctorRating(doctor._id, 5)"
            [ngClass]="(rateFive==true)?'fa fa-2x fa-star':'fa fa-2x fa-star-o'"></span>
    </span>
      </div>
    </div>
  </div>
  <div class="card-footer">
    <small class="text-muted">
      <!--<button class="btn btn-primary" (click)="onAddRequestClick()">Request examination</button>-->
      <!--<button class="btn btn-primary fa fa-2x fa-trash float-right" (click)="onClick($event)"></button>-->
      <div class="row">
        <div class="col-auto align-self-start">
          <button class="btn btn-primary" (click)="onAddRequestClick()">Examination</button>

        </div>
        <div class="col-auto align-self-center" *ngIf="showDetails">
          <button class="btn btn-primary fa fa-2x fa-info" (click)="navigateToDetail()"></button>
        </div>
        <div class="col align-self-end">
          <button class="btn btn-primary fa fa-2x fa-trash float-right" (click)="onClick($event)"></button>
        </div>
      </div>
    </small>
  </div>
</div>


<div class="modal" id="myModal" [style.display]="showModal ? 'block' : 'none'">
  <div class="modal-dialog">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">Choose doctor</h4>
        <button type="button" class="close" data-dismiss="modal" (click)="hide()">&times;</button>
      </div>

      <!-- Modal body -->
      <div class="modal-body">
        <div class="row">
          Please confirm doctor {{doctor.firstname}} {{doctor.surname}} removal
        </div>
      </div>

      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-primary float-left" data-dismiss="modal" (click)="hide()">Cancel</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="confirmDoctorRemova(doctor._id)">
          Confirm
        </button>
      </div>

    </div>
  </div>
</div>

<div class="modal" [style.display]="showAddRequestModal ? 'block' : 'none'">
  <div class="modal-dialog">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">Send request to doctor</h4>
        <button type="button" class="close" data-dismiss="modal" (click)="hideAddRquest()">&times;</button>
      </div>

      <!-- Modal body -->
      <div class="modal-body">
        <div class="row">
          <div class="col-12">

            You are sending request to doctor {{doctor.firstname}} {{doctor.surname}}. Please fill following
            informations.
          </div>
        </div>
        <div class="row">
          <div class="col-12">
            Examination type:
          </div>
        </div>
        <div class="row">
          <div class="col-12">

            <input [(ngModel)]="eventtype"><br>
          </div>
        </div>
        <div class="row">
          <div class="col-12">
            Examination description:
          </div>
        </div>
        <input [(ngModel)]="message"><br>
        <div class="row">
          <div class="col-12">
            Examination date:
          </div>
        </div>
        <!--<input [(ngModel)]="date">-->
        <div class="row">
          <div class="col-12">
            <dl-date-time-picker
              startView="day"
              maxView="year"
              minView="minute"
              minuteStep="5"
              [(ngModel)]="date"
            >
            </dl-date-time-picker>
          </div>
        </div>

      </div>

      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-primary float-left" data-dismiss="modal" (click)="hideAddRquest()">Cancel
        </button>
        <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="confirmAddRequest(doctor._id)">
          Confirm
        </button>
      </div>

    </div>
  </div>
</div>
