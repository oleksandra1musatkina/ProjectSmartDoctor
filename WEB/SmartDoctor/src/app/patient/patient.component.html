<p *ngIf="error" class="error">{{error | json}}</p>

<div class="card">
  <img *ngIf="patient && patient.image" class="card-img-top" src="assets/uploads/{{patient.image}}" height="250"
       alt="Card image cap">
  <img *ngIf="!patient || !patient.image" class="card-img-top" src="assets/zena.jpg" alt="Card image cap" height="250">
  <div class="card-body">
    <div class="text-center">

      <h5 class="card-title">{{patient.firstname}} {{patient.surname}}</h5>

    </div>

    <div class="well well-sm">
      <div class="row">
        <div class="col-xs-12 col-md-6 text-center">
          <h1 class="rating-num"> {{score}}</h1>
          <div class="rating">
            <span class="fa fa-star"></span>
            <span class="fa fa-star"></span>
            <span class="fa fa-star"></span>
            <span class="fa fa-star"></span>
            <span class="fa fa-star-o"></span>
          </div>
          <div>
            <span class="fa fa-user"></span>{{numberOfRatins}} total
          </div>
        </div>
        <div class="col-xs-12 col-md-6">
          <div class="row rating-desc">
            <div class="col-xs-3 col-md-3 text-right">
              <span class="fa fa-star">5</span>
            </div>
            <div class="col-xs-8 col-md-9">
              <div class="progress progress-striped">
                <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="20"
                     aria-valuemin="0" aria-valuemax="100" [ngStyle]="{'width' : fiveStarsPercentage+'%'}">
                  <span class=" sr-only            ">80%</span>
                </div>
              </div>
            </div>
            <!-- end 5 -->
            <div class="col-xs-3 col-md-3 text-right">
              <span class="fa fa-star">4</span>
            </div>
            <div class="col-xs-8 col-md-9">
              <div class="progress">
                <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="20"
                     aria-valuemin="0" aria-valuemax="100" [ngStyle]="{'width' : fourStarsPercentage+'%'}">
                  <span class="sr-only">60%</span>
                </div>
              </div>
            </div>
            <!-- end 4 -->
            <div class="col-xs-3 col-md-3 text-right">
              <span class="fa fa-star">3</span>
            </div>
            <div class="col-xs-8 col-md-9">
              <div class="progress">
                <div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="20"
                     aria-valuemin="0" aria-valuemax="100" [ngStyle]="{'width' : threeStarsPercentage+'%'}">
                  <span class="sr-only">40%</span>
                </div>
              </div>
            </div>
            <!-- end 3 -->
            <div class="col-xs-3 col-md-3 text-right">
              <span class="fa fa-star">2</span>
            </div>
            <div class="col-xs-8 col-md-9">
              <div class="progress">
                <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="20"
                     aria-valuemin="0" aria-valuemax="100" [ngStyle]="{'width' : twoStarsPercentage+'%'}">
                  <span class="sr-only">20%</span>
                </div>
              </div>
            </div>
            <!-- end 2 -->
            <div class="col-xs-3 col-md-3 text-right">
              <span class="fa fa-star">1</span>
            </div>
            <div class="col-xs-8 col-md-9">
              <div class="progress">
                <div class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="80"
                     aria-valuemin="0" aria-valuemax="100" [ngStyle]="{'width' : oneStarsPercentage+'%'}">
                  <span class="sr-only">15%</span>
                </div>
              </div>
            </div>
            <!-- end 1 -->
          </div>
          <!-- end row -->
        </div>
      </div>
    </div>
  </div>
  <div class="card-footer">
    <small class="text-muted">
      <div class="row">
        <div class="col-auto align-self-start">
          <button class="btn btn-success" (click)="onAddRequestClick()">Examination</button>

        </div>
        <div class="col-auto align-self-center" *ngIf="showDetails">
          <button class="btn btn-success fa fa-2x fa-info" (click)="navigateToDetail()"></button>
        </div>
        <div class="col align-self-end">
          <button class="btn btn-success fa fa-2x fa-trash float-right" (click)="onClick($event)"></button>
        </div>
      </div>

    </small>

  </div>
</div>


<div class="modal" id="myModal" [style.display]="showModal ? 'block' : 'none'">
  <div class="modal-dialog">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">Choose patient</h4>
        <button type="button" class="close" data-dismiss="modal" (click)="hide()">&times;</button>
      </div>

      <!-- Modal body -->
      <div class="modal-body">
        <div class="row">
          Please confirm patient {{patient.firstname}} {{patient.surname}} removal
        </div>
      </div>

      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-success float-left" data-dismiss="modal" (click)="hide()">Cancel</button>
        <button type="button" class="btn btn-success" data-dismiss="modal" (click)="confirmPatientRemoval(patient._id)">
          Confirm
        </button>
      </div>

    </div>
  </div>
</div>

<div class="modal" [style.display]="showAddRequestModal ? 'block' : 'none'">
  <div class="modal-dialog">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">Send request to doctor</h4>
        <button type="button" class="close" data-dismiss="modal" (click)="hideAddRquest()">&times;</button>
      </div>

      <!-- Modal body -->
      <div class="modal-body">
        <div class="row">
          <div class="col-12">

            You are sending request to doctor {{patient.firstname}} {{patient.surname}}. Please fill following
            informations.
          </div>
        </div>
        <div class="row">
          <div class="col-12">
            Examination type:
          </div>
        </div>
        <div class="row">
          <div class="col-12">

            <input [(ngModel)]="eventtype"><br>
          </div>
        </div>
        <div class="row">
          <div class="col-12">
            Examination description:
          </div>
        </div>
        <input [(ngModel)]="message"><br>
        <div class="row">
          <div class="col-12">
            Examination date:
          </div>
        </div>
        <!--<input [(ngModel)]="date">-->
        <div class="row">
          <div class="col-12">
            <dl-date-time-picker
              startView="day"
              maxView="year"
              minView="minute"
              minuteStep="5"
              [(ngModel)]="date"
            >
            </dl-date-time-picker>
          </div>
        </div>
      </div>

      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-success float-left" data-dismiss="modal" (click)="hideAddRquest()">Cancel
        </button>
        <button type="button" class="btn btn-success" data-dismiss="modal" (click)="confirmAddRequest(patient._id)">
          Confirm
        </button>
      </div>

    </div>
  </div>
</div>
